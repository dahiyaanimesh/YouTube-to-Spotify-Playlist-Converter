{% extends "base.html" %}

{% block title %}Home - YouTube to Spotify Converter{% endblock %}

{% block content %}
<!-- Hero Section - Compact -->
<div class="text-center mb-4">
    <h1 class="display-5 fw-bold mb-3 hero-title">
        <i class="fab fa-youtube text-danger me-2"></i>
        <i class="fas fa-arrow-right hero-text mx-2"></i>
        <i class="fab fa-spotify text-success ms-2"></i>
    </h1>
    <h2 class="h4 mb-3 hero-subtitle">YouTube to Spotify Converter</h2>
    <p class="lead hero-description mb-0">
        Transform your favorite YouTube playlists into Spotify playlists with just a few clicks.
    </p>
</div>

<!-- Features - Inline -->
<div class="row text-center mb-4">
    <div class="col-md-4 mb-2">
        <div class="d-flex align-items-center justify-content-center">
            <i class="fas fa-magic fa-2x text-primary me-3"></i>
            <div class="text-start">
                <h6 class="feature-title mb-1">Smart Matching</h6>
                <small class="feature-description">Advanced algorithms for best matches</small>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-2">
        <div class="d-flex align-items-center justify-content-center">
            <i class="fas fa-bolt fa-2x text-warning me-3"></i>
            <div class="text-start">
                <h6 class="feature-title mb-1">Lightning Fast</h6>
                <small class="feature-description">Convert playlists in seconds</small>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-2">
        <div class="d-flex align-items-center justify-content-center">
            <i class="fas fa-shield-alt fa-2x text-success me-3"></i>
            <div class="text-start">
                <h6 class="feature-title mb-1">Secure & Private</h6>
                <small class="feature-description">Safe OAuth authentication</small>
            </div>
        </div>
    </div>
</div>

<!-- Main Content - Side by Side Layout -->
<div class="row">
    <!-- Left Column - Conversion Form -->
    <div class="col-lg-7 mb-4">
        <div class="card shadow-lg h-100">
            <div class="card-header text-center py-3">
                <h4 class="mb-0">
                    <i class="fas fa-exchange-alt me-2"></i>
                    Convert Your Playlist
                </h4>
            </div>
            <div class="card-body p-4">
                {% if not session.spotify_user_name %}
                    <!-- Not Logged In -->
                    <div class="text-center">
                        <div class="mb-4">
                            <i class="fab fa-spotify fa-4x text-success mb-3"></i>
                            <h5>Connect Your Spotify Account</h5>
                            <p class="text-muted">
                                First, you need to connect your Spotify account to create playlists.
                                Don't worry, we only request the permissions we need!
                            </p>
                        </div>
                        <a href="{{ url_for('login') }}" class="btn btn-success btn-lg">
                            <i class="fab fa-spotify me-2"></i>
                            Connect with Spotify
                        </a>
                        <div class="mt-3">
                            <small class="text-muted">
                                <i class="fas fa-lock me-1"></i>
                                Secure OAuth - We never store your password
                            </small>
                        </div>
                    </div>
                {% else %}
                    <!-- Logged In - Show Form -->
                    <form action="{{ url_for('transfer') }}" method="POST" id="convertForm">
                        <div class="mb-4">
                            <label for="playlist_url" class="form-label fw-bold">
                                <i class="fab fa-youtube text-danger me-2"></i>
                                YouTube Playlist URL
                            </label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="fas fa-link"></i>
                                </span>
                                <input 
                                    type="url" 
                                    class="form-control form-control-lg" 
                                    id="playlist_url" 
                                    name="playlist_url" 
                                    placeholder="https://www.youtube.com/playlist?list=..." 
                                    required
                                >
                            </div>
                            <div class="form-text">
                                <i class="fas fa-info-circle me-1"></i>
                                Copy and paste the URL of any public YouTube playlist
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="playlist_name" class="form-label fw-bold">
                                <i class="fab fa-spotify text-success me-2"></i>
                                Spotify Playlist Name (Optional)
                            </label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="fas fa-music"></i>
                                </span>
                                <input 
                                    type="text" 
                                    class="form-control form-control-lg" 
                                    id="playlist_name" 
                                    name="playlist_name" 
                                    placeholder="Leave empty to auto-generate from YouTube title"
                                    maxlength="100"
                                >
                            </div>
                            <div class="form-text">
                                <i class="fas fa-lightbulb me-1"></i>
                                If left empty, we'll create a name based on the YouTube playlist
                            </div>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg" id="convertBtn">
                                <i class="fas fa-magic me-2"></i>
                                Convert to Spotify
                            </button>
                        </div>
                    </form>

                    <!-- Loading State -->
                    <div id="loadingState" class="text-center d-none p-4 rounded">
                        <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <h5 class="mb-2">Converting Your Playlist...</h5>
                        <p class="text-secondary">This may take a few moments depending on playlist size</p>
                        
                        <!-- Progress indicator -->
                        <div class="mt-3">
                            <div class="progress mb-2" style="height: 8px;">
                                <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary" 
                                     role="progressbar" style="width: 100%"></div>
                            </div>
                            <small class="text-muted">
                                <span id="loadingStep">Fetching playlist...</span>
                            </small>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Right Column - Help & Info -->
    <div class="col-lg-5">
        <!-- How it works -->
        <div class="card bg-dark mb-4">
            <div class="card-body">
                <h6 class="card-title">
                    <i class="fas fa-question-circle text-info me-2"></i>
                    How it works
                </h6>
                <ol class="mb-0">
                    <li>Connect your Spotify account</li>
                    <li>Paste a YouTube playlist URL</li>
                    <li>Click convert and wait for the magic</li>
                    <li>Enjoy your new Spotify playlist!</li>
                </ol>
            </div>
        </div>

        <!-- Tips -->
        <div class="card bg-dark mb-4">
            <div class="card-body">
                <h6 class="card-title">
                    <i class="fas fa-lightbulb text-warning me-2"></i>
                    Tips for best results
                </h6>
                <ul class="mb-0">
                    <li>Use playlists with clear song titles</li>
                    <li>Music videos work better than remixes</li>
                    <li>Popular songs have higher match rates</li>
                    <li>Check your Spotify for unmatched tracks</li>
                </ul>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="card bg-dark text-white">
            <div class="card-body text-center">
                <h6 class="card-title">
                    <i class="fas fa-chart-line text-warning me-2"></i>
                    Conversion Stats
                </h6>
                <div class="row text-center">
                    <div class="col-4">
                        <h5 class="mb-1">85%</h5>
                        <small>Avg Success Rate</small>
                    </div>
                    <div class="col-4">
                        <h5 class="mb-1">&lt;30s</h5>
                        <small>Avg Time</small>
                    </div>
                    <div class="col-4">
                        <h5 class="mb-1">100K+</h5>
                        <small>Songs Converted</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// The form handling is now done in main.js
console.log('Form handler loaded');
</script>
{% endblock %}
