{% extends "base.html" %}

{% block title %}Home - YouTube to Spotify Converter{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <!-- Hero Section -->
        <div class="text-center mb-5">
            <h1 class="display-4 fw-bold mb-4 text-white">
                <i class="fab fa-youtube text-danger me-3"></i>
                <i class="fas fa-arrow-right text-white mx-2"></i>
                <i class="fab fa-spotify text-success ms-3"></i>
            </h1>
            <h2 class="mb-4 text-white">YouTube to Spotify Converter</h2>
            <p class="lead text-white">
                Transform your favorite YouTube playlists into Spotify playlists with just a few clicks.
                Discover your music in a whole new way!
            </p>
        </div>

        <!-- Features -->
        <div class="row mb-5">
            <div class="col-md-4 text-center mb-3">
                <div class="feature-icon mb-3">
                    <i class="fas fa-magic fa-3x text-primary"></i>
                </div>
                <h5 class="text-white">Smart Matching</h5>
                <p class="text-white">Advanced algorithms to find the best matches for your tracks</p>
            </div>
            <div class="col-md-4 text-center mb-3">
                <div class="feature-icon mb-3">
                    <i class="fas fa-bolt fa-3x text-warning"></i>
                </div>
                <h5 class="text-white">Lightning Fast</h5>
                <p class="text-white">Convert entire playlists in seconds, not hours</p>
            </div>
            <div class="col-md-4 text-center mb-3">
                <div class="feature-icon mb-3">
                    <i class="fas fa-shield-alt fa-3x text-success"></i>
                </div>
                <h5 class="text-white">Secure & Private</h5>
                <p class="text-white">Your data is safe with secure OAuth authentication</p>
            </div>
        </div>

        <!-- Conversion Form -->
        <div class="card shadow-lg">
            <div class="card-header bg-gradient text-white text-center py-4" style="background: linear-gradient(135deg, #1DB954, #191414);">
                <h4 class="mb-0">
                    <i class="fas fa-exchange-alt me-2"></i>
                    Convert Your Playlist
                </h4>
            </div>
            <div class="card-body p-4">
                {% if not session.spotify_user_name %}
                    <!-- Not Logged In -->
                    <div class="text-center">
                        <div class="mb-4">
                            <i class="fab fa-spotify fa-5x text-success mb-3"></i>
                            <h5>Connect Your Spotify Account</h5>
                            <p class="text-muted">
                                First, you need to connect your Spotify account to create playlists.
                                Don't worry, we only request the permissions we need!
                            </p>
                        </div>
                        <a href="{{ url_for('login') }}" class="btn btn-success btn-lg">
                            <i class="fab fa-spotify me-2"></i>
                            Connect with Spotify
                        </a>
                        <div class="mt-3">
                            <small class="text-muted">
                                <i class="fas fa-lock me-1"></i>
                                Secure OAuth - We never store your password
                            </small>
                        </div>
                    </div>
                {% else %}
                    <!-- Logged In - Show Form -->
                    <form action="{{ url_for('transfer') }}" method="POST" id="convertForm">
                        <div class="mb-4">
                            <label for="playlist_url" class="form-label fw-bold">
                                <i class="fab fa-youtube text-danger me-2"></i>
                                YouTube Playlist URL
                            </label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="fas fa-link"></i>
                                </span>
                                <input 
                                    type="url" 
                                    class="form-control form-control-lg" 
                                    id="playlist_url" 
                                    name="playlist_url" 
                                    placeholder="https://www.youtube.com/playlist?list=..." 
                                    required
                                >
                            </div>
                            <div class="form-text">
                                <i class="fas fa-info-circle me-1"></i>
                                Copy and paste the URL of any public YouTube playlist
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="playlist_name" class="form-label fw-bold">
                                <i class="fab fa-spotify text-success me-2"></i>
                                Spotify Playlist Name (Optional)
                            </label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="fas fa-music"></i>
                                </span>
                                <input 
                                    type="text" 
                                    class="form-control form-control-lg" 
                                    id="playlist_name" 
                                    name="playlist_name" 
                                    placeholder="Leave empty to auto-generate from YouTube title"
                                    maxlength="100"
                                >
                            </div>
                            <div class="form-text">
                                <i class="fas fa-lightbulb me-1"></i>
                                If left empty, we'll create a name based on the YouTube playlist
                            </div>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg" id="convertBtn">
                                <i class="fas fa-magic me-2"></i>
                                Convert to Spotify
                            </button>
                        </div>
                    </form>

                    <!-- Loading State -->
                    <div id="loadingState" class="text-center d-none p-4 bg-white rounded">
                        <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <h5 class="text-dark mb-2">Converting Your Playlist...</h5>
                        <p class="text-secondary">This may take a few moments depending on playlist size</p>
                        
                        <!-- Progress indicator -->
                        <div class="mt-3">
                            <div class="progress mb-2" style="height: 8px;">
                                <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary" 
                                     role="progressbar" style="width: 100%"></div>
                            </div>
                            <small class="text-muted">
                                <span id="loadingStep">Fetching playlist...</span>
                            </small>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Help Section -->
        <div class="mt-5">
            <div class="row">
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h6 class="card-title">
                                <i class="fas fa-question-circle text-info me-2"></i>
                                How it works
                            </h6>
                            <ol class="mb-0">
                                <li>Connect your Spotify account</li>
                                <li>Paste a YouTube playlist URL</li>
                                <li>Click convert and wait for the magic</li>
                                <li>Enjoy your new Spotify playlist!</li>
                            </ol>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h6 class="card-title">
                                <i class="fas fa-tips text-warning me-2"></i>
                                Tips for best results
                            </h6>
                            <ul class="mb-0">
                                <li>Use playlists with clear song titles</li>
                                <li>Music videos work better than remixes</li>
                                <li>Popular songs have higher match rates</li>
                                <li>Check your Spotify for unmatched tracks</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// The form handling is now done in main.js
console.log('Form handler loaded');
</script>
{% endblock %}
